# Define character sets
$lettersLower = 'abcdefghijklmnopqrstuvwxyz'
$lettersUpper = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
$numbers = '0123456789'
$specials = '!@#$%^&*()-_=+[]{}?'

# Pick random characters from each set
$pickNumbers = -join ((1..3) | ForEach-Object { $numbers[(Get-Random -Minimum 0 -Maximum $numbers.Length)] })
$pickSpecials = -join ((1..3) | ForEach-Object { $specials[(Get-Random -Minimum 0 -Maximum $specials.Length)] })
$pickUppers = -join ((1..3) | ForEach-Object { $lettersUpper[(Get-Random -Minimum 0 -Maximum $lettersUpper.Length)] })
$pickLowers = -join ((1..3) | ForEach-Object { $lettersLower[(Get-Random -Minimum 0 -Maximum $lettersLower.Length)] })

# Combine and shuffle all characters
$passwordChars = ($pickNumbers + $pickSpecials + $pickUppers + $pickLowers).ToCharArray() | Sort-Object {Get-Random}

# Join into a final password
$password = -join $passwordChars
Write-Output $password
